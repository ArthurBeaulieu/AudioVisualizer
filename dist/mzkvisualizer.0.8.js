!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=9)}({10:function(t,e,i){},12:function(t,e,i){"use strict";i.r(e);var s=class{constructor(t){this._type=null,this._player=null,this._renderTo=null,this._fftSize=null,this._audioCtx=null,this._inputNode=null,this._nodes={source:null,analyser:null},this._isPlaying=!1,this._canvas=null,this._ctx=null,this._parentDimension={position:null,height:null,width:null,zIndex:null},this._dom={container:null},this._resizeObserver=null,this._onResize=this._onResize.bind(this),this._play=this._play.bind(this),this._pause=this._pause.bind(this),this._processAudioBin=this._processAudioBin.bind(this),this._dblClick=this._dblClick.bind(this),this._fillAttributes(t),this._buildUI(),this._setAudioNodes(),this._addEvents()}destroy(){this._removeEvents(),Object.keys(this).forEach(t=>{delete this[t]})}_fillAttributes(t){this._type=t.type,this._player=t.player,this._renderTo=t.renderTo,this._fftSize=t.fftSize,this._audioCtx=t.audioContext,this._inputNode=t.input}_buildUI(){this._dom.container=document.createElement("DIV"),this._dom.container.classList.add(`mzk-${this._type}`),this._canvas=document.createElement("CANVAS"),this._ctx=this._canvas.getContext("2d"),this._ctx.translate(.5,.5),this._canvas.width=this._renderTo.offsetWidth-2,this._canvas.height=this._renderTo.offsetHeight-2,this._dom.container.appendChild(this._canvas),this._renderTo.appendChild(this._dom.container)}_setAudioNodes(){let t=!1;this._audioCtx?(t=!0,this._nodes.source=this._inputNode):(this._audioCtx=new AudioContext,this._nodes.source=this._audioCtx.createMediaElementSource(this._player)),this._nodes.analyser=this._audioCtx.createAnalyser(),this._nodes.analyser.fftSize=this._fftSize,this._nodes.source.connect(this._nodes.analyser),t||this._nodes.analyser.connect(this._audioCtx.destination)}_addEvents(){this._resizeObserver=new ResizeObserver(this._onResize).observe(this._renderTo),this._player.addEventListener("play",this._play,!1),this._player.addEventListener("pause",this._pause,!1),this._dom.container.addEventListener("dblclick",this._dblClick,!1)}_removeEvents(){this._resizeObserver.disconnect(),this._player.removeEventListener("play",this._play,!1),this._player.removeEventListener("pause",this._pause,!1),this._dom.container.removeEventListener("dblclick",this._dblClick,!1)}_play(){this._isPlaying=!0,this._processAudioBin()}_pause(){this._isPlaying=!1}_onResize(){this._canvas.width=this._renderTo.offsetWidth-2,this._canvas.height=this._renderTo.offsetHeight-2}_dblClick(t){document.fullscreenElement?(document.exitFullscreen(),this._renderTo.style.position=this._parentDimension.position,this._renderTo.style.height=this._parentDimension.height,this._renderTo.style.width=this._parentDimension.width,this._renderTo.style.zIndex=this._parentDimension.zIndex,this._parentDimension={position:null,height:null,width:null,zIndex:null}):(document.documentElement.requestFullscreen(),this._parentDimension={position:this._renderTo.style.position,height:this._renderTo.style.height,width:this._renderTo.style.width,zIndex:this._renderTo.style.zIndex||""},this._renderTo.style.position="fixed",this._renderTo.style.height="100vh",this._renderTo.style.width="100vw",this._renderTo.style.zIndex="999")}_clearCanvas(){this._canvas.getContext("2d").clearRect(0,0,this._canvas.width,this._canvas.height)}};var n=class{constructor(){}static drawRadialGradient(t,e){const i=t.getContext("2d"),s=i.createRadialGradient(e.x0,e.y0,e.r0,e.x1,e.y1,e.r1);for(let t=0;t<e.colors.length;++t)s.addColorStop(e.colors[t].center,e.colors[t].color);i.fillStyle=s,i.fillRect(0,0,t.width,t.height)}static drawVerticalFrequencyGradient(t,e){const i=t.getContext("2d"),s=i.createLinearGradient(0,t.height,0,0);for(let t=0;t<e.colors.length;++t)s.addColorStop(e.colors[t].center,e.colors[t].color);i.fillStyle=s,i.fillRect(e.originX,t.height-e.frequencyHeight,e.frequencyWidth,e.frequencyHeight)}static drawRadialGlowGradient(t,e){const i=t.getContext("2d"),s=i.createRadialGradient(e.centerX,e.centerY,0,e.centerX,e.centerY,e.radius);for(let t=0;t<e.colors.length;++t)s.addColorStop(e.colors[t].center,e.colors[t].color);i.fillStyle=s,i.fill()}static peakMeterGradient(t,e){const i=t.getContext("2d");let s=null;if("horizontal"===e.orientation)s=i.createLinearGradient(0,0,t.width,0);else{if("vertical"!==e.orientation)return;s=i.createLinearGradient(0,t.height,0,0)}for(let t=0;t<e.colors.length;++t)s.addColorStop(e.colors[t].center,e.colors[t].color);i.fillStyle=s,i.fill()}static lightenDarkenColor(t,e){let i=!1;"#"===t[0]&&(t=t.slice(1),i=!0),e+=16;const s=parseInt(t,16);let n=(s>>16)+e;n>255?n=255:n<0&&(n=0);let a=(s>>8&255)+e;a>255?a=255:a<0&&(a=0);let o=(255&s)+e;return o>255?o=255:o<0&&(o=0),(i?"#":"")+(o|a<<8|n<<16).toString(16)}static get defaultBackgroundColor(){return"#1D1E25"}static get defaultTextColor(){return"#E7E9E7"}static get defaultPrimaryColor(){return"#56D45B"}static get defaultAudioGradient(){return["#56D45B","#AFF2B3","#FFAD67","#FF6B67","#FFBAB8"]}};var a=class{constructor(){}static drawRadialBar(t,e){const i=t.getContext("2d");let s=e.frequency/255;s<.05?s=-s:s*=1.33,i.beginPath(),i.moveTo(e.x0,e.y0),i.lineTo(e.x1,e.y1),i.strokeStyle=n.lightenDarkenColor(e.color,100*s),i.lineWidth=e.width,i.stroke(),i.closePath()}static drawCircle(t,e){const i=t.getContext("2d");i.beginPath(),i.arc(e.centerX,e.centerY,e.radius,e.radStart,e.radEnd),i.lineWidth=e.width,i.strokeStyle=e.color||"#FFF",i.stroke(),i.closePath()}static drawCircleGlow(t,e){const i=t.getContext("2d");i.beginPath(),i.arc(e.centerX,e.centerY,e.radius,e.radStart,e.radEnd),n.drawRadialGlowGradient(t,e),i.closePath()}static drawDisc(t,e){const i=t.getContext("2d");i.beginPath(),i.arc(e.centerX,e.centerY,e.radius,e.radStart,e.radEnd),i.fillStyle=e.color||"#FFF",i.fill(),i.closePath()}static drawVerticalFrequencyBar(t,e){const i=t.getContext("2d");i.beginPath(),i.fillRect(e.originX,t.height-e.frequencyHeight,e.frequencyWidth,e.frequencyHeight),n.drawVerticalFrequencyGradient(t,e),i.closePath()}static drawOscilloscope(t,e){const i=t.getContext("2d");i.beginPath();let s=0;const n=t.width/e.samples;for(let a=0;a<e.samples;++a){const o=e.timeDomain[a]/255,h=t.height*o;a>0?i.lineTo(s,h):i.moveTo(s,h),s+=n}i.strokeStyle=e.color,i.stroke(),i.closePath()}static drawPointsOscilloscope(t,e){const i=t.getContext("2d");i.beginPath();for(let s=0;s<e.length;++s){let n=t.height*(e.times[s]/255),a=t.height-n-1,o=t.width/e.length;i.fillStyle=e.color,i.fillRect(s*o,a,2,2)}i.stroke(),i.fill(),i.closePath()}static drawRadialOscilloscope(t,e){const i=t.getContext("2d");i.beginPath(),i.save(),i.translate(e.centerX,e.centerY),i.rotate(e.rotation),i.translate(-e.centerX,-e.centerY),i.moveTo(e.points[0].dx,e.points[0].dy);for(let t=0;t<e.length-1;++t){let s=e.points[t];s.dx=s.x+e.times[t]*Math.sin(Math.PI/180*s.angle),s.dy=s.y+e.times[t]*Math.cos(Math.PI/180*s.angle);let n=(s.dx+e.points[t+1].dx)/2,a=(s.dy+e.points[t+1].dy)/2;i.quadraticCurveTo(s.dx,s.dy,n,a)}let s=e.times[e.length-1],n=e.points[e.length-1];n.dx=n.x+s*Math.sin(Math.PI/180*n.angle),n.dy=n.y+s*Math.cos(Math.PI/180*n.angle);let a=(n.dx+e.points[0].dx)/2,o=(n.dy+e.points[0].dy)/2;i.quadraticCurveTo(n.dx,n.dy,a,o),i.quadraticCurveTo(a,o,e.points[0].dx,e.points[0].dy),i.lineWidth=1,i.lineCap="round",i.stroke(),i.restore(),i.closePath()}static drawPeakMeter(t,e){const i=t.getContext("2d");if(n.peakMeterGradient(t,e),"horizontal"===e.orientation){const s=t.width-e.amplitude;i.fillRect(0,0,s,t.height)}else if("vertical"===e.orientation){const s=t.height-e.amplitude;i.fillRect(0,t.height-s,t.width,s)}if(i.fillStyle="#FF6B67","horizontal"===e.orientation){const s=t.width-e.peak;i.fillRect(s,0,1,t.height)}else if("vertical"===e.orientation){const s=t.height-e.peak;i.fillRect(0,t.height-s,t.width,1)}}static precisionRound(t,e){const i=Math.pow(10,e||0);return Math.round(t*i)/i}};var o=class extends s{constructor(t){super(t),this._barGradient=[{color:t.colors&&t.colors.min||n.defaultAudioGradient[0],center:0},{color:t.colors&&t.colors.step0||n.defaultAudioGradient[1],center:.7},{color:t.colors&&t.colors.step1||n.defaultAudioGradient[2],center:.833},{color:t.colors&&t.colors.step2||n.defaultAudioGradient[3],center:.9},{color:t.colors&&t.colors.max||n.defaultAudioGradient[4],center:1}],this._canvas.style.backgroundColor=t.colors&&t.colors.background||n.defaultBackgroundColor}_fillAttributes(t){super._fillAttributes(t)}_processAudioBin(){if(!0===this._isPlaying){this._clearCanvas();const t=new Uint8Array(this._nodes.analyser.frequencyBinCount);this._nodes.analyser.getByteFrequencyData(t);const e=this._canvas.width/this._nodes.analyser.frequencyBinCount;let i=0;for(let s=0;s<this._nodes.analyser.frequencyBinCount;++s){let n=t[s]/255*this._canvas.height;a.drawVerticalFrequencyBar(this._canvas,{frequencyHeight:n,frequencyWidth:e,colors:this._barGradient,originX:i}),i+=e}requestAnimationFrame(this._processAudioBin)}}};class h{constructor(t,e,i=0,s=132){this.radius=.4,this.color="#0F8489",this.x=Math.random()*(2*t)-t,this.y=Math.random()*(2*e)-e,this._z=Math.max(2*t/(2*e)),this._maxDepth=Math.max(2*t/(2*e)),Math.abs(this.x)>Math.abs(this.y)?(this._dx=1,this._dy=Math.abs(this.y/this.x)):(this._dx=Math.abs(this.x/this.y),this._dy=1),this._dx*=this.x>0?1:-1,this._dy*=this.y>0?1:-1,this._dz=-.1,this.y>e/2?this.color="#71C9CD":i>s&&(this.color="#FF6B67")}updatePosition(t,e){this.x+=this._dx*t,this.y+=this._dy*t,this._z+=this._dz,this._dx+=.001*this._dx,this._dy+=.001*this._dy,this.radius=e+.1*(this._maxDepth-this._z)}}class r{constructor(t){this._height=t.height,this._width=t.width,this._total=t.total,this._index=t.index,this._value=256*Math.random(),this._radius=Math.abs(this._width,this._height)/8,this.angle=360*this._index/this._total,this.x=this._width/2+this._radius*Math.sin(Math.PI/180*this.angle),this.y=this._height/2+this._radius*Math.cos(Math.PI/180*this.angle),this.dx=this.x+this._value*Math.sin(Math.PI/180*this.angle),this.dy=this.y+this._value*Math.cos(Math.PI/180*this.angle)}}var l=class extends s{constructor(t){super(t)}_fillAttributes(t){super._fillAttributes(t),this._imageSrc=null,this._centerX=null,this._centerY=null,this._radius=null,this._radialSection=null,this._barCount=null,this._barMaxHeight=null,this._circleStrokeWidth=null,this._stars=[],this._points=[],this._oscilloscopeRotation=null,this._dom.logo=null,this._averageBreakpoint=132,this._averageHit=!1,this._imageSrc=t.image||"assets/img/manazeak-logo-small.svg",this._dom.logo=document.createElement("IMG"),this._dom.logo.classList.add("paused"),this._dom.logo.src=this._imageSrc}_buildUI(){super._buildUI(),this._dom.container.appendChild(this._dom.logo),this._buildBackgroundBase()}_onResize(){super._onResize(),this._circleStrokeWidth=2,this._barCount=this._nodes.analyser.frequencyBinCount,this._centerX=this._canvas.width/2,this._centerY=this._canvas.height/2,this._barMaxHeight=this._canvas.height/8,this._radius=this._canvas.height/4-this._canvas.height/16,this._radialSection=2*Math.PI/this._barCount,this._stars=[];for(let t=0;t<1500;++t)this._stars.push(new h(this._centerX,this._centerY,null,this._averageBreakpoint));this._points=[];for(let t=0;t<this._fftSize/2;++t)this._points.push(new r({index:t,height:this._canvas.height,width:this._canvas.width,total:this._fftSize/2}));this._buildBackgroundBase()}_play(){super._play(),this._dom.logo.classList.remove("paused")}_pause(){super._pause(),this._dom.logo.classList.add("paused")}_processAudioBin(){if(!0===this._isPlaying){this._clearCanvas(),this._buildBackgroundBase();const t=new Uint8Array(this._nodes.analyser.frequencyBinCount),e=new Uint8Array(this._nodes.analyser.frequencyBinCount);this._nodes.analyser.getByteFrequencyData(t),this._nodes.analyser.getByteTimeDomainData(e);let i=this._getAverageFrequency(t);this._averageHit=i>this._averageBreakpoint,this._animateCircleBars(t),this._animateStars(i),this._animateCircleGlow(i),this._animateOscilloscopes(e),requestAnimationFrame(this._processAudioBin)}}_buildBackgroundBase(){n.drawRadialGradient(this._canvas,{x0:this._centerX,y0:this._centerY,r0:this._radius,x1:this._centerX,y1:this._centerY,r1:this._canvas.width/2.66,colors:[{color:"#3C405D",center:0},{color:"#060609",center:1}]}),a.drawCircle(this._canvas,{centerX:this._centerX,centerY:this._centerY,radius:this._radius,radStart:0,radEnd:2*Math.PI,width:2*this._circleStrokeWidth})}_animateCircleBars(t){const e=Math.round(this._radialSection*this._radius);for(let i=0;i<t.length;++i){const s=t[i]/255*this._barMaxHeight;a.drawRadialBar(this._canvas,{x0:this._centerX+Math.cos(this._radialSection*i-Math.PI/2)*(this._radius+this._circleStrokeWidth),y0:this._centerY+Math.sin(this._radialSection*i-Math.PI/2)*(this._radius+this._circleStrokeWidth),x1:this._centerX+Math.cos(this._radialSection*i-Math.PI/2)*(this._radius+this._circleStrokeWidth+s),y1:this._centerY+Math.sin(this._radialSection*i-Math.PI/2)*(this._radius+this._circleStrokeWidth+s),width:e,color:this._averageHit?"#56D45B":"#37C340",frequency:t[i]})}}_animateStars(t){let e=this._averageHit?t/20:t/60;for(let i=0;i<this._stars.length;++i){let s=this._stars[i];s.updatePosition(e,.6),(s.x<-this._centerX||s.x>this._centerX||s.y<-this._centerY||s.y>this._centerY)&&(s=new h(this._centerX,this._centerY,t,this._averageBreakpoint),this._stars[i]=s),a.drawDisc(this._canvas,{centerX:s.x+this._centerX,centerY:s.y+this._centerY,radius:s.radius,radStart:2*Math.PI,radEnd:!1,color:s.color})}}_animateCircleGlow(t){a.drawCircleGlow(this._canvas,{centerX:this._centerX,centerY:this._centerY,radius:2*(1.33*this._radius+t),radStart:0,radEnd:2*Math.PI,colors:[{color:"rgba(0, 0, 0, 0)",center:.48},{color:this._averageHit?"#56D45B":"#48ABAF",center:.5},{color:"rgba(0, 0, 0, 0)",center:.52}]})}_animateOscilloscopes(t){this._averageHit?(this._oscilloscopeRotation+=.05,this._ctx.strokeStyle="rgba(255, 193, 140, .7)"):(this._oscilloscopeRotation+=-.05,this._ctx.strokeStyle="rgba(125, 228, 132, 0.25)"),a.drawRadialOscilloscope(this._canvas,{points:this._points,times:t,length:this._fftSize/2,centerX:this._centerX,centerY:this._centerY,rotation:this._oscilloscopeRotation}),this._averageHit&&a.drawPointsOscilloscope(this._canvas,{times:t,length:this._fftSize/2,color:"rgba(113, 201, 205, .7)"})}_getAverageFrequency(t){let e=0;for(let i=0;i<t.length;++i)e+=t[i];return e/t.length}};var d=class{constructor(t){this._type=null,this._player=null,this._renderTo=null,this._fftSize=null,this._audioCtx=null,this._inputNode=null,this._merged=null,this._nodes={source:null,splitter:null,merger:null,analyser:null,analyserL:null,analyserR:null},this._canvasL=null,this._canvasR=null,this._ctxL=null,this._ctxR=null,this._dom={container:null},this._parentDimension={position:null,height:null,width:null,zIndex:null},this._resizeObserver=null,this._onResize=this._onResize.bind(this),this._play=this._play.bind(this),this._pause=this._pause.bind(this),this._processAudioBin=this._processAudioBin.bind(this),this._dblClick=this._dblClick.bind(this),this._fillAttributes(t),this._buildUI(),this._setAudioNodes(),this._addEvents()}destroy(){this._removeEvents(),Object.keys(this).forEach(t=>{delete this[t]})}_fillAttributes(t){this._type=t.type,this._player=t.player,this._renderTo=t.renderTo,this._fftSize=t.fftSize||1024,this._audioCtx=t.audioContext,this._inputNode=t.input,this._merged=t.merged||!1}_buildUI(){this._dom.container=document.createElement("DIV"),this._dom.container.classList.add(`mzk-${this._type}`),this._canvasL=document.createElement("canvas"),this._canvasR=document.createElement("canvas"),this._ctxL=this._canvasL.getContext("2d"),this._ctxR=this._canvasR.getContext("2d"),this._ctxL.translate(.5,.5),this._ctxR.translate(.5,.5),this._dom.container.appendChild(this._canvasL),this._dom.container.appendChild(this._canvasR),this._renderTo.appendChild(this._dom.container)}_setAudioNodes(){let t=!1;this._audioCtx?(t=!0,this._nodes.source=this._inputNode):(this._audioCtx=new AudioContext,this._nodes.source=this._audioCtx.createMediaElementSource(this._player));let e=null;if(!0===this._merged?(this._nodes.analyser=this._audioCtx.createAnalyser(),this._nodes.analyser.fftSize=this._fftSize,this._nodes.source.connect(this._nodes.analyser),e=this._nodes.analyser):(this._nodes.splitter=this._audioCtx.createChannelSplitter(this._nodes.source.channelCount),this._nodes.merger=this._audioCtx.createChannelMerger(this._nodes.source.channelCount),this._nodes.analyserL=this._audioCtx.createAnalyser(),this._nodes.analyserR=this._audioCtx.createAnalyser(),this._nodes.analyserR.fftSize=this._fftSize,this._nodes.analyserL.fftSize=this._fftSize,this._nodes.source.connect(this._nodes.splitter),this._nodes.splitter.connect(this._nodes.analyserL,0),this._nodes.splitter.connect(this._nodes.analyserR,1),this._nodes.analyserL.connect(this._nodes.merger,0,0),this._nodes.analyserR.connect(this._nodes.merger,0,1),e=this._nodes.merger),t){const t=this._audioCtx.createGain();t.gain.value=0,e.connect(t),t.connect(this._audioCtx.destination)}else e.connect(this._audioCtx.destination)}_addEvents(){this._resizeObserver=new ResizeObserver(this._onResize).observe(this._renderTo),this._player.addEventListener("play",this._play,!1),this._player.addEventListener("pause",this._pause,!1),this._dom.container.addEventListener("dblclick",this._dblClick,!1)}_removeEvents(){this._resizeObserver.disconnect(),this._player.removeEventListener("play",this._play,!1),this._player.removeEventListener("pause",this._pause,!1),this._dom.container.removeEventListener("dblclick",this._dblClick,!1)}_play(){this._isPlaying=!0,this._processAudioBin()}_pause(){this._isPlaying=!1}_onResize(){}_dblClick(t){document.fullscreenElement?(document.exitFullscreen(),this._renderTo.style.position=this._parentDimension.position,this._renderTo.style.height=this._parentDimension.height,this._renderTo.style.width=this._parentDimension.width,this._renderTo.style.zIndex=this._parentDimension.zIndex,this._parentDimension={position:null,height:null,width:null,zIndex:null}):(document.documentElement.requestFullscreen(),this._parentDimension={position:this._renderTo.style.position,height:this._renderTo.style.height,width:this._renderTo.style.width,zIndex:this._renderTo.style.zIndex||""},this._renderTo.style.position="fixed",this._renderTo.style.height="100vh",this._renderTo.style.width="100vw",this._renderTo.style.zIndex="999")}_clearCanvas(){this._canvasL.getContext("2d").clearRect(0,0,this._canvasL.width,this._canvasL.height),this._canvasR.getContext("2d").clearRect(0,0,this._canvasR.width,this._canvasR.height)}};var c=class extends d{constructor(t){super(t),this._colors={signal:t.colors&&t.colors.signal||ColorUtils.defaultPrimaryColor};const e=t.colors&&t.colors.background||ColorUtils.defaultBackgroundColor;!0===this._merged?this._canvas.style.backgroundColor=e:(this._canvasL.style.backgroundColor=e,this._canvasR.style.backgroundColor=e),this._updateDimensions()}_fillAttributes(t){super._fillAttributes(t),this._dimension={height:null,canvasHeight:null,width:null}}_buildUI(){super._buildUI(),!0===this._merged&&this._dom.container.removeChild(this._canvasR)}_onResize(){super._onResize(),this._updateDimensions()}_processAudioBin(){!0===this._isPlaying&&(this._clearCanvas(),!0===this._merged?this._mergedStereoAnalysis():this._stereoAnalysis(),requestAnimationFrame(this._processAudioBin))}_mergedStereoAnalysis(){let t=new Uint8Array(this._nodes.analyser.frequencyBinCount);this._nodes.analyser.getByteTimeDomainData(t),a.drawOscilloscope(this._canvasL,{samples:this._nodes.analyser.frequencyBinCount,timeDomain:t,color:this._colors.signal})}_stereoAnalysis(){let t=new Uint8Array(this._nodes.analyserL.frequencyBinCount);this._nodes.analyserL.getByteTimeDomainData(t),a.drawOscilloscope(this._canvasL,{samples:this._nodes.analyserL.frequencyBinCount,timeDomain:t,color:this._colors.signal}),this._nodes.analyserR.getByteTimeDomainData(t),a.drawOscilloscope(this._canvasR,{samples:this._nodes.analyserR.frequencyBinCount,timeDomain:t,color:this._colors.signal})}_updateDimensions(){this._dimension.height=this._renderTo.offsetHeight-4,this._dimension.width=this._renderTo.offsetWidth-2,this._dimension.canvasHeight=this._dimension.height/2,!0===this._merged?(this._canvasL.width=this._dimension.width,this._canvasL.height=2*this._dimension.canvasHeight):(this._canvasL.width=this._dimension.width,this._canvasL.height=this._dimension.canvasHeight,this._canvasR.width=this._dimension.width,this._canvasR.height=this._dimension.canvasHeight)}};var _=class extends d{constructor(t){super(t),this._updateDimensions(),this._createLogarithmicScaleHeights(),!0===this._merged?this._canvasL.style.backgroundColor="black":(this._canvasL.style.backgroundColor="black",this._canvasR.style.backgroundColor="black")}_fillAttributes(t){super._fillAttributes(t),this._scaleType=t.scale||"linear",this._colorSmoothing=t.colorSmoothing||!1,this._canvasSpeed=1,this._bufferCanvas=null,this._bufferCtx=null,this._dom.settings=null,this._dom.settingsPanel=null,this._dimension={height:null,canvasHeight:null,width:null},this._logScale=[],this._settingsClicked=this._settingsClicked.bind(this),this._clickedElsewhere=this._clickedElsewhere.bind(this)}_buildUI(){super._buildUI(),this._bufferCanvas=document.createElement("CANVAS"),this._bufferCtx=this._bufferCanvas.getContext("2d"),!0===this._merged&&this._dom.container.removeChild(this._canvasR),this._canvasL.width=this._dimension.width,this._canvasL.height=this._dimension.canvasHeight,this._canvasR.width=this._dimension.width,this._canvasR.height=this._dimension.canvasHeight,this._bufferCanvas.width=this._dimension.width,this._bufferCanvas.height=this._dimension.canvasHeight,this._dom.settings=document.createElement("IMG"),this._dom.settings.classList.add("mzkspectrum-settings"),this._dom.settings.src="./assets/img/settings.svg",this._dom.settingsPanel=document.createElement("DIV"),this._dom.settingsPanel.classList.add("mzkspectrum-settings-panel"),this._dom.settingsPanel.innerHTML=`\n      <h3>Settings</h3>\n      <form>\n        <p class="legend">Scale:</p>\n        <label for="linear">Linear</label>\n        <input type="radio" id="id-linear" name="scale" value="linear" ${"linear"===this._scaleType?"checked":""}>\n        <label for="logarithmic">Logarithmic</label>\n        <input type="radio" id="id-logarithmic" name="scale" value="logarithmic" ${"logarithmic"===this._scaleType?"checked":""}>\n        <p class="smooth-color">\n          <label for="smoothColor">Smooth colors</label>\n          <input type="checkbox" id="smoothColor" name="smoothColor" ${this._colorSmoothing?"checked":""}>\n        </p>\n      </form>\n    `;const t=this._dom.settingsPanel.querySelector("form");t.addEventListener("change",e=>{e.preventDefault();const i=new FormData(t),s=[];for(const t of i)s.push(t[1]);this._scaleType=s[0],"on"===s[1]?this._colorSmoothing=!0:this._colorSmoothing=!1},!1),this._dom.container.appendChild(this._dom.settingsPanel),this._dom.container.appendChild(this._dom.settings),this._dom.settings.addEventListener("click",this._settingsClicked,!1)}_removeEvents(){super._removeEvents(),document.body.removeEventListener("click",this._clickedElsewhere,!1)}_updateDimensions(){this._dimension.width=this._renderTo.offsetWidth-2,!0===this._merged?(this._dimension.height=this._renderTo.offsetHeight-2,this._dimension.canvasHeight=this._dimension.height):(this._dimension.height=this._renderTo.offsetHeight-4,this._dimension.canvasHeight=this._dimension.height/2)}_settingsClicked(){!1===this._dom.settingsPanel.classList.contains("opened")&&(this._dom.settings.classList.add("opened"),this._dom.settingsPanel.classList.add("opened"),document.body.addEventListener("click",this._clickedElsewhere,!1))}_clickedElsewhere(t){t.target.closest(".mzkspectrum-settings")||t.target.closest(".mzkspectrum-settings-panel")||(this._dom.settings.classList.remove("opened"),this._dom.settingsPanel.classList.remove("opened"),document.body.removeEventListener("click",this._clickedElsewhere,!1))}_processAudioBin(t){!0===this._isPlaying&&(!0===this._merged?this._mergedStereoAnalysis():this._stereoAnalysis(),requestAnimationFrame(this._processAudioBin))}_mergedStereoAnalysis(){const t=new Uint8Array(this._nodes.analyser.frequencyBinCount);this._nodes.analyser.getByteFrequencyData(t),this._drawSpectrogramForFrequencyBin(this._canvasL,t)}_stereoAnalysis(){const t=new Uint8Array(this._nodes.analyserL.frequencyBinCount),e=new Uint8Array(this._nodes.analyserR.frequencyBinCount);this._nodes.analyserL.getByteFrequencyData(t),this._nodes.analyserR.getByteFrequencyData(e),this._drawSpectrogramForFrequencyBin(this._canvasL,t),this._drawSpectrogramForFrequencyBin(this._canvasR,e)}_drawSpectrogramForFrequencyBin(t,e){const i=t.getContext("2d");this._bufferCtx.drawImage(t,0,0,this._dimension.width,this._dimension.canvasHeight);for(let t=0;t<e.length;++t)"linear"===this._scaleType?this._fillRectLinear(i,e,t):this._fillRectLogarithm(i,e,t);i.translate(-this._canvasSpeed,0),i.drawImage(this._bufferCanvas,0,0,this._dimension.width,this._dimension.canvasHeight,0,0,this._dimension.width,this._dimension.canvasHeight),i.setTransform(1,0,0,1,0,0)}_fillRectLinear(t,e,i){const s=this._scaleLinearIndexToHeight(i),n=this._dimension.canvasHeight/e.length;if(0!==i&&this._colorSmoothing){const a=t.createLinearGradient(0,this._dimension.canvasHeight-s-n,0,this._dimension.canvasHeight-s);a.addColorStop(0,`rgb(${e[i]}, ${e[i]}, ${e[i]})`),a.addColorStop(1,`rgb(${e[i-1]}, ${e[i-1]}, ${e[i-1]})`),t.fillStyle=a}else t.fillStyle=`rgb(${e[i]}, ${e[i]}, ${e[i]})`;t.fillRect(this._dimension.width-this._canvasSpeed,this._dimension.canvasHeight-s-n,this._canvasSpeed,n)}_fillRectLogarithm(t,e,i){if(0!==i&&i!==e.length-1&&this._colorSmoothing){const s=t.createLinearGradient(0,this._logScale[i],0,this._logScale[i-1]);s.addColorStop(0,`rgb(${e[i]}, ${e[i]}, ${e[i]})`),s.addColorStop(1,`rgb(${e[i-1]}, ${e[i-1]}, ${e[i-1]})`),t.fillStyle=s}else t.fillStyle=`rgb(${e[i]}, ${e[i]}, ${e[i]})`;t.fillRect(this._dimension.width-this._canvasSpeed,this._logScale[i-1],this._canvasSpeed,this._logScale[i]-this._logScale[i-1])}_scaleLinearIndexToHeight(t){const e=this._fftSize/2;return t*this._dimension.canvasHeight/e}_createLogarithmicScaleHeights(){return new Promise(t=>{this._logScale=[this._dimension.canvasHeight];for(let t=1;t<this._fftSize/2;++t)this._logScale.push(this._computeLogSampleHeight(t));t()})}_computeLogSampleHeight(t){return this._dimension.canvasHeight-Math.log(t)/Math.log(10)/(Math.log(this._fftSize/2)/Math.log(10))*this._dimension.canvasHeight}_onResize(){super._onResize(),this._updateDimensions(),this._createLogarithmicScaleHeights(),this._canvasL.width=this._dimension.width,this._canvasL.height=this._dimension.canvasHeight,!1===this._merged&&(this._canvasR.width=this._dimension.width,this._canvasR.height=this._dimension.canvasHeight),this._bufferCanvas.width=this._dimension.width,this._bufferCanvas.height=this._dimension.canvasHeight}};var u=class extends d{constructor(t){super(t),this._peakGradient=[{color:t.colors&&t.colors.min||ColorUtils.defaultAudioGradient[0],center:0},{color:t.colors&&t.colors.step0||ColorUtils.defaultAudioGradient[1],center:.7},{color:t.colors&&t.colors.step1||ColorUtils.defaultAudioGradient[2],center:.833},{color:t.colors&&t.colors.step2||ColorUtils.defaultAudioGradient[3],center:.9},{color:t.colors&&t.colors.max||ColorUtils.defaultAudioGradient[4],center:1}];const e=t.colors&&t.colors.background||ColorUtils.defaultBackgroundColor;!0===this._merged?this._canvas.style.backgroundColor=e:(this._canvasL.style.backgroundColor=e,this._canvasR.style.backgroundColor=e)}_fillAttributes(t){super._fillAttributes(t),this._orientation=t.orientation||"horizontal",this._legend=t.legend||null,this._legend?(this._dbScaleMin=t.legend.dbScaleMin||60,this._dbScaleTicks=t.legend.dbScaleTicks||15):(this._dbScaleMin=60,this._dbScaleTicks=15),this._amplitudeL=0,this._amplitudeR=0,this._peakL=0,this._peakR=0,this._peakSetTimeL=null,this._peakSetTimeR=null,this._dom.scaleContainer=null,this._dom.labels=[]}_buildUI(){super._buildUI(),"horizontal"===this._orientation&&this._dom.container.classList.add("horizontal-peakmeter"),this._legend&&(this._dom.scaleContainer=document.createElement("DIV"),this._dom.scaleContainer.classList.add("scale-container"),this._dom.container.insertBefore(this._dom.scaleContainer,this._dom.container.firstChild)),!0===this._merged&&this._dom.container.removeChild(this._canvasR),this._updateDimensions(),this._legend&&(this._createPeakLabel(),this._createScaleTicks())}_setAudioNodes(){super._setAudioNodes(),this._peakSetTimeL=this._audioCtx.currentTime,this._peakSetTimeR=this._audioCtx.currentTime}_pause(){super._pause(),this._legend&&(this._dom.labels[0].textContent="-∞",this._dom.labels[1].textContent="-∞")}_onResize(){super._onResize(),this._updateDimensions(),this._legend&&(this._createPeakLabel(),this._createScaleTicks())}_processAudioBin(){!0===this._isPlaying&&(this._clearCanvas(),!0===this._merged?this._mergedStereoAnalysis():this._stereoAnalysis(),requestAnimationFrame(this._processAudioBin))}_mergedStereoAnalysis(){const t=new Float32Array(this._fftSize);this._nodes.analyser.getFloatTimeDomainData(t);let e=0;for(let i=0;i<t.length;i++)e+=t[i]**2;const i=10*Math.log10(e/t.length),s=-1*this._dbScaleMin;"horizontal"===this._orientation?this._amplitudeL=Math.floor(i*this._canvasL.width/s):"vertical"===this._orientation&&(this._amplitudeL=Math.floor(i*this._canvasL.height/s)),this._peakL>this._amplitudeL?(this._peakL=this._amplitudeL,this._peakSetTimeL=this._audioCtx.currentTime,this._legend&&i!==-1/0&&(this._dom.labels[0].textContent=a.precisionRound(i,1))):this._audioCtx.currentTime-this._peakSetTimeL>1&&(this._peakL=this._amplitudeL,this._peakSetTimeL=this._audioCtx.currentTime,this._legend&&i!==-1/0&&(this._dom.labels[0].textContent=a.precisionRound(i,1))),a.drawPeakMeter(this._canvasL,{amplitude:this._amplitudeL,peak:this._peakL,orientation:this._orientation,colors:this._peakGradient})}_stereoAnalysis(){const t=new Float32Array(this._fftSize),e=new Float32Array(this._fftSize);this._nodes.analyserL.getFloatTimeDomainData(t),this._nodes.analyserR.getFloatTimeDomainData(e);let i=0,s=0;for(let n=0;n<t.length;n++)i+=t[n]**2,s+=e[n]**2;const n=10*Math.log10(i/t.length),o=10*Math.log10(s/e.length),h=-1*this._dbScaleMin;"horizontal"===this._orientation?(this._amplitudeL=Math.floor(n*this._canvasL.width/h),this._amplitudeR=Math.floor(o*this._canvasR.width/h)):"vertical"===this._orientation&&(this._amplitudeL=Math.floor(n*this._canvasL.height/h),this._amplitudeR=Math.floor(o*this._canvasR.height/h)),this._peakL>this._amplitudeL?(this._peakL=this._amplitudeL,this._peakSetTimeL=this._audioCtx.currentTime,this._legend&&n!==-1/0&&(this._dom.labels[0].textContent=a.precisionRound(n,1))):this._audioCtx.currentTime-this._peakSetTimeL>1&&(this._peakL=this._amplitudeL,this._peakSetTimeL=this._audioCtx.currentTime,this._legend&&n!==-1/0&&(this._dom.labels[0].textContent=a.precisionRound(n,1))),this._peakR>this._amplitudeR?(this._peakR=this._amplitudeR,this._peakSetTimeR=this._audioCtx.currentTime,this._legend&&o!==-1/0&&(this._dom.labels[1].textContent=a.precisionRound(o,1))):this._audioCtx.currentTime-this._peakSetTimeR>1&&(this._peakR=this._amplitudeL,this._peakSetTimeR=this._audioCtx.currentTime,this._legend&&o!==-1/0&&(this._dom.labels[1].textContent=a.precisionRound(o,1))),a.drawPeakMeter(this._canvasL,{amplitude:this._amplitudeL,peak:this._peakL,orientation:this._orientation,colors:this._peakGradient}),a.drawPeakMeter(this._canvasR,{amplitude:this._amplitudeR,peak:this._peakR,orientation:this._orientation,colors:this._peakGradient})}_createScaleTicks(){const t=Math.floor(this._dbScaleMin/this._dbScaleTicks);let e=0;if(this._dom.scaleContainer.innerHTML="","horizontal"===this._orientation){const i=this._canvasL.width/t;for(let s=0;s<t;++s){const t=document.createElement("DIV");this._dom.scaleContainer.appendChild(t),t.style.width=`${i}px`,t.textContent=`${e}`,e-=this._dbScaleTicks}}else{const i=this._canvasL.height/t;for(let s=0;s<t;++s){const t=document.createElement("DIV");this._dom.scaleContainer.appendChild(t),t.style.height=`${i}px`,t.textContent=`${e}`,e-=this._dbScaleTicks}}}_createPeakLabel(){2===this._dom.labels.length&&(this._dom.container.removeChild(this._dom.labels[0]),this._dom.container.removeChild(this._dom.labels[1]),this._dom.labels=[]);const t=document.createElement("DIV"),e=document.createElement("DIV");t.classList.add("peak-value-container"),e.classList.add("peak-value-container"),t.textContent="-∞",e.textContent="-∞","horizontal"===this._orientation?(t.style.width="28px",t.style.height=`${this._canvasL.height+2}px`,t.style.top="14px",e.style.width="28px",e.style.height=`${this._canvasL.height+2}px`,e.style.top=`${this._canvasL.height+16}px`):(t.style.width=`${this._canvasL.width+2}px`,t.style.left="18px",e.style.width=`${this._canvasL.width+2}px`,e.style.left=`${this._canvasL.width+20}px`),this._dom.labels.push(t),this._dom.labels.push(e),this._dom.container.appendChild(this._dom.labels[0]),this._dom.container.appendChild(this._dom.labels[1])}_updateDimensions(){let t=0,e=0;"horizontal"===this._orientation?(this._legend&&(t=30,e=14),this._canvasL.width=this._renderTo.offsetWidth-t,!0===this._merged?(this._canvasL.height=this._renderTo.offsetHeight-e-2,this._canvasR.height=this._renderTo.offsetHeight-e-2):(this._canvasR.width=this._renderTo.offsetWidth-t,this._canvasL.height=(this._renderTo.offsetHeight-e)/2-2,this._canvasR.height=(this._renderTo.offsetHeight-e)/2-2),this._legend&&(this._dom.scaleContainer.style.width=`${this._canvasL.width}px`)):"vertical"===this._orientation&&(this._legend?(t=18,e=16):this._canvasL.style.left=0,this._canvasL.height=this._renderTo.offsetHeight-e-2,!0===this._merged?(this._canvasL.width=this._renderTo.offsetWidth-t-2,this._canvasR.width=this._renderTo.offsetWidth-t-2):(this._canvasR.height=this._renderTo.offsetHeight-e-2,this._canvasL.width=(this._renderTo.offsetWidth-t)/2-2,this._canvasR.width=(this._renderTo.offsetWidth-t)/2-2),this._legend&&(this._dom.scaleContainer.style.height=`${this._canvasL.height}px`,this._dom.scaleContainer.style.width="18px"))}};var g=class extends s{constructor(t){super(t),this._colors={background:t.colors.background||n.defaultBackgroundColor,track:t.colors.track||n.defaultTextColor,progress:t.colors.progress||n.defaultPrimaryColor},this._canvas.style.backgroundColor=this._colors.background,""!==this._player.src&&this._getPlayerSourceFile()}_fillAttributes(t){super._fillAttributes(t),this._animation=t.animation,this._merged=t.merged,this._bars=null,this._offlineCtx=null,this._offlineBuffer=null,this._dataL=[],this._dataR=[],this._trackLoaded=this._trackLoaded.bind(this),this._seekPlayer=this._seekPlayer.bind(this)}_buildUI(){super._buildUI(),this._bars=this._canvas.width/3}_addEvents(){super._addEvents(),this._player.addEventListener("loadedmetadata",this._trackLoaded,!1),this._dom.container.addEventListener("click",this._seekPlayer,!1)}_removeEvents(){super._removeEvents(),this._player.removeEventListener("loadedmetadata",this._trackLoaded,!1),this._dom.container.removeEventListener("click",this._seekPlayer,!1)}_onResize(){super._onResize(),this._bars=this._canvas.width/3,this._fillData(),this._clearCanvas(),this._drawFileWaveform(this._player.currentTime/this._player.duration)}_dblClick(){}_trackLoaded(){cancelAnimationFrame(this._processAudioBin),this._clearCanvas(),this._getPlayerSourceFile()}_seekPlayer(t){const e=t.target.getBoundingClientRect(),i=t.clientX-e.left;this._player.currentTime=i/this._canvas.width*this._player.duration,this._clearCanvas(),this._drawFileWaveform(this._player.currentTime/this._player.duration)}_processAudioFile(t){this._offlineCtx=new OfflineAudioContext(2,this._audioCtx.sampleRate*this._player.duration,this._audioCtx.sampleRate),this._offlineSource=this._offlineCtx.createBufferSource(),this._audioCtx.decodeAudioData(t,t=>{this._offlineSource.buffer=t,this._offlineSource.connect(this._offlineCtx.destination),this._offlineSource.start(),this._offlineCtx.startRendering().then(t=>{this._offlineBuffer=t,this._fillData(),this._drawFileWaveform(0)}).catch(function(t){console.log("Rendering failed: "+t)})})}_fillData(){this._offlineBuffer&&(!0===this._merged?this._dataL=this._genScaledMonoData(this._offlineBuffer):(this._dataL=this._genScaledData(this._offlineBuffer.getChannelData(0)),this._dataR=this._genScaledData(this._offlineBuffer.getChannelData(1))))}_genScaledData(t){const e=Math.floor(t.length/this._bars),i=[];for(let s=0;s<=t.length-e;s+=e){let n=0;for(let i=0;i<e;++i)n+=Math.abs(t[s+i]);i.push(n/e)}return this._scaleDataToHeight(i)}_genScaledMonoData(t){const e=t.getChannelData(0),i=t.getChannelData(1),s=Math.floor(e.length/this._bars),n=[];for(let t=0;t<=e.length-s;t+=s){let a=0;for(let n=0;n<s;++n)a+=(Math.abs(e[t+n])+Math.abs(i[t+n]))/2;n.push(a/s)}return this._scaleDataToHeight(n)}_scaleDataToHeight(t){const e=Math.max(...t),i=Math.min(...t),s=e-i,n=.9*this._canvas.height;let a=[];for(let e=0;e<t.length;++e)a.push((t[e]-i)*n/s);return a}_drawFileWaveform(t){var e=this._canvas.width/this._bars;const i=e/8;this._ctx.beginPath();for(let s=0;s<this._dataL.length;++s){const a=this._dataL[s]/2,o=!0===this._merged?this._dataL[s]/2:this._dataR[s]/2;if(this._ctx.fillStyle=this._colors.track,e*(s+1)/this._canvas.width>t&&e*s/this._canvas.width<t){const a=this._ctx.createLinearGradient(e*s+i,0,e*(s+1)-i,0);let o=e*(s+1)-e*s,h=t*this._canvas.width,r=Math.abs(h-e*s)/o;if("gradient"===this._animation)r+.01<1?(a.addColorStop(0,this._colors.progress),a.addColorStop(r,this._colors.progress),a.addColorStop(r+.01,this._colors.track),a.addColorStop(1,this._colors.track),this._ctx.fillStyle=a):this._ctx.fillStyle=this._colors.progress;else{const t=Math.round(255*r);this._ctx.fillStyle=n.lightenDarkenColor(this._colors.progress,255-t)}}else s/this._dataL.length<t&&(this._ctx.fillStyle=this._colors.progress);this._ctx.fillRect(e*s+i,this._canvas.height/2-a,e-2*i,a),this._ctx.fillRect(e*s+i,this._canvas.height/2,e-2*i,o),this._ctx.fillRect(e*s+i,this._canvas.height/2-.15,e-2*i,.15)}this._ctx.closePath()}_getPlayerSourceFile(){const t=new XMLHttpRequest;t.open("GET",this._player.src,!0),t.responseType="arraybuffer",t.onload=(()=>{this._processAudioFile(t.response)}),t.send()}_processAudioBin(){!0===this._isPlaying&&(this._clearCanvas(),this._drawFileWaveform(this._player.currentTime/this._player.duration),requestAnimationFrame(this._processAudioBin))}};window.AudioContext=window.AudioContext||window.webkitAudioContext;class m{constructor(t){return"frequencybars"===t.type?new o(t):"frequencycircle"===t.type?new l(t):"oscilloscope"===t.type?new c(t):"spectrum"===t.type?new _(t):"peakmeter"===t.type?new u(t):"waveformprogress"===t.type?new g(t):null}}window.MzkVisualizer=m;e.default=m},9:function(t,e,i){i(12),t.exports=i(10)}});